<!-- Christmas Snowfall Effect -->
<div class="snowflakes" id="snowflakes-container" aria-hidden="true"></div>

<script>
(function() {
    // Configuration
    const SNOWFLAKE_COUNT = 60; // Moderate snowfall
    const MIN_SIZE = 3;
    const MAX_SIZE = 6;
    const MIN_DURATION = 10;
    const MAX_DURATION = 20;
    const MIN_OPACITY = 0.4;
    const MAX_OPACITY = 0.7;

    // Create snowflakes
    function createSnowflakes() {
        const container = document.getElementById('snowflakes-container');
        if (!container) return;

        for (let i = 0; i < SNOWFLAKE_COUNT; i++) {
            const snowflake = document.createElement('div');
            snowflake.className = 'snowflake';

            // Random properties
            const size = Math.random() * (MAX_SIZE - MIN_SIZE) + MIN_SIZE;
            const left = Math.random() * 100;
            const duration = Math.random() * (MAX_DURATION - MIN_DURATION) + MIN_DURATION;
            const delay = Math.random() * MAX_DURATION;
            const opacity = Math.random() * (MAX_OPACITY - MIN_OPACITY) + MIN_OPACITY;

            // Apply styles
            snowflake.style.width = size + 'px';
            snowflake.style.height = size + 'px';
            snowflake.style.left = left + '%';
            snowflake.style.animationDuration = duration + 's';
            snowflake.style.animationDelay = delay + 's';
            snowflake.style.setProperty('--snowflake-opacity', opacity);

            // Override opacity in animation
            snowflake.style.cssText += `
                width: ${size}px;
                height: ${size}px;
                left: ${left}%;
                animation-duration: ${duration}s;
                animation-delay: ${delay}s;
            `;

            container.appendChild(snowflake);
        }

        // Update animation to use custom opacity
        updateSnowflakeOpacity();
    }

    function updateSnowflakeOpacity() {
        const snowflakes = document.querySelectorAll('.snowflake');
        snowflakes.forEach((flake, index) => {
            const opacity = Math.random() * (MAX_OPACITY - MIN_OPACITY) + MIN_OPACITY;
            // Create unique animation for each snowflake with its own opacity
            const duration = parseFloat(flake.style.animationDuration) || 15;
            flake.style.animation = `snowfall ${duration}s linear infinite`;
            flake.style.animationDelay = flake.style.animationDelay || '0s';

            // Use CSS custom property for opacity variation
            flake.style.setProperty('--flake-opacity', opacity);
        });
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', createSnowflakes);
    } else {
        createSnowflakes();
    }
})();
</script>

<style>
/* Override snowflake animation with variable opacity */
.snowflake {
    animation-name: snowfall;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

@keyframes snowfall {
    0% {
        transform: translateY(-10px) translateX(0) rotate(0deg);
        opacity: 0;
    }
    10% {
        opacity: var(--flake-opacity, 0.5);
    }
    90% {
        opacity: var(--flake-opacity, 0.5);
    }
    100% {
        transform: translateY(100vh) translateX(20px) rotate(360deg);
        opacity: 0;
    }
}
</style>
